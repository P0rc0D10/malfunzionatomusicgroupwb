<!-- https://www.cgfootman.com/2020/06/06/add-responsive-images-to-a-hugo-site/ -->

<div class="gallery">
    {{ $images := where (.Resources.ByType "image") "Name" "!=" "cover.jpg" }}
    <!-- {{ mod (len $images) 2 }} -->
    <ul>
        {{ range $img := $images }}
        <!-- { { if gt $img.Width $img.Height }} -->
        <!-- { { if lt $img.Width $img.Height }} -->
        {{ $tinyw := default "400x" }}
        {{ $smallw := default "800x" }}
        {{ $mediumw := default "1200x" }}
        {{ $largew := default "1600x" }}
        {{ $.Scratch.Set "tiny" ($img.Resize $tinyw) }}
        {{ $.Scratch.Set "small" ($img.Resize $smallw) }}
        {{ $.Scratch.Set "medium" ($img.Resize $mediumw) }}
        {{ $.Scratch.Set "large" ($img.Resize $largew) }}
        {{ $tiny := $.Scratch.Get "tiny" }}
        {{ $small := $.Scratch.Get "small" }}
        {{ $medium := $.Scratch.Get "medium" }}
        {{ $large := $.Scratch.Get "large" }}
        <li>
            <figure>
                <img 
                    alt="{{ .Title }}"
                    sizes="(min-width: 400px) 1200px, 100vw"
                    srcset='
                        {{ if ge $img.Width "400" }}{{ with $tiny.RelPermalink }}{{.}} 400w{{ end }}{{ end }}
                        {{ if ge $img.Width "800" }}{{ with $small.RelPermalink }}, {{.}} 800w{{ end }}{{ end }}
                        {{ if ge $img.Width "1200" }}{{ with $medium.RelPermalink }}, {{.}} 1200w{{ end }}{{ end }}
                        {{ if ge $img.Width "1600" }}{{ with $large.RelPermalink }}, {{.}} 1600w {{ end }}{{ end }}'
                    src="{{ $img.RelPermalink }}">
                <figcaption class="meta">
                    <div class="exif">
                    {{ with $img.Exif }}
                        {{ with .Tags }}
                            {{ with .DateTimeOriginal }}
                                {{ if hasPrefix . "0000:00:00" }}
                                {{ else }}
                                    {{ (time .).Format "15:04" }}
                                {{ end }}
                            {{ end }}
                        {{ end }}
                    {{ end }}
                    </div>
                    <!--<a href="{{ $img.RelPermalink }}">SRC</a>-->
                </figcaption>
            </figure>
        </li>
        {{ end }}
    </ul>
    {{ with .Params.photos }}
    <div class="photographer">
        <i class="ic-copyright"></i>
        <span>Photos by</span>
        <span>{{- . | safeHTML -}}</span>
    </div>
    {{ end }}
</div>


