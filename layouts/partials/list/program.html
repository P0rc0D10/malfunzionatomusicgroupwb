{{ $events := .Scratch.Get "events" }}
{{ $show_artists := .Scratch.Get "show_artists" | default true }}

{{ define "partials/inline-event" }}
<li class="event">
    <a href="{{ .RelPermalink }}" class="title" id="{{ .File.ContentBaseName }}">{{ .Title }}</a>
    {{ partial "meta/date" . }}
    {{ .Scratch.Set "show_address" false }}{{ partial "meta/location" . }}
    <div class="artists">
        {{ partial "artists" . }}
    </div>
</li>
{{ end }}

<ol class="program" reversed>

    {{ if eq $events nil }}
        {{ range where .RegularPagesRecursive.ByDate.Reverse "Section" "program" }}
            {{ partial "inline-event" . }} 
        {{ end }}
    {{ else }}
        {{ range $events }}
            {{  partial "inline-event" . }} 
        {{ end }}
    {{ end }}

    {{ if $show_artists }}
    <script src="{{ (resources.Get "/script/program-list.js").Permalink }}" async></script>
    {{ end }}
</ol>

